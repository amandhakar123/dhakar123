"use client"

import React, { createContext, useContext, useState, useEffect } from 'react'

export interface Language {
  code: string
  name: string
  nativeName: string
  flag: string
}

export const supportedLanguages: Language[] = [
  { code: 'en', name: 'English', nativeName: 'English', flag: 'ЁЯЗ║ЁЯЗ╕' },
  { code: 'hi', name: 'Hindi', nativeName: 'рд╣рд┐рдВрджреА', flag: 'ЁЯЗоЁЯЗ│' },
  { code: 'or', name: 'Odia', nativeName: 'рмУрмбрм╝рм┐рмЖ', flag: 'ЁЯФ╕' },
  { code: 'bn', name: 'Bengali', nativeName: 'ржмрж╛ржВрж▓рж╛', flag: 'ЁЯФ╣' },
  { code: 'te', name: 'Telugu', nativeName: 'р░др▒Жр░▓р▒Бр░Чр▒Б', flag: 'ЁЯФ╢' },
  { code: 'ta', name: 'Tamil', nativeName: 'родрооро┐ро┤рпН', flag: 'ЁЯФ║' },
  { code: 'gu', name: 'Gujarati', nativeName: 'ркЧрлБркЬрк░рк╛ркдрлА', flag: 'ЁЯФ╗' },
  { code: 'mr', name: 'Marathi', nativeName: 'рдорд░рд╛рдареА', flag: 'ЁЯФ╖' },
  { code: 'kn', name: 'Kannada', nativeName: 'р▓Хр▓ир│Нр▓ир▓б', flag: 'ЁЯФ╕' },
  { code: 'ml', name: 'Malayalam', nativeName: 'р┤ор┤▓р┤пр┤╛р┤│р┤В', flag: 'ЁЯФ╣' },
]

interface Translations {
  [key: string]: {
    [key: string]: string
  }
}

const translations: Translations = {
  en: {
    // Common
    'welcome': 'Welcome',
    'home': 'Home',
    'profile': 'Profile',
    'settings': 'Settings',
    'games': 'Games',
    'lessons': 'Lessons',
    'dashboard': 'Dashboard',
    'logout': 'Logout',
    'save': 'Save',
    'cancel': 'Cancel',
    'edit': 'Edit',
    'delete': 'Delete',
    'back': 'Back',
    'next': 'Next',
    'previous': 'Previous',
    'loading': 'Loading...',
    'error': 'Error',
    'success': 'Success',
    
    // Home page
    'hero.title': 'Educational Games Store',
    'hero.subtitle': 'Enhance learning through interactive games and challenges',
    'platform.title': 'Welcome to EduGamers',
    'platform.subtitle': 'Choose your role to access the platform',
    'role.student': 'Student',
    'role.teacher': 'Teacher',
    'role.government': 'Government',
    'role.student.desc': 'Play games, track progress, submit assignments',
    'role.teacher.desc': 'Manage students, create assignments, view analytics',
    'role.government.desc': 'View regional data, track implementation, manage policies',
    'explore.games': 'Explore Games',
    'get.started': 'Get Started',
    'solar.status': 'Solar Powered - Active',
    
    // Profile page
    'profile.title': 'My Profile',
    'profile.edit': 'Edit Profile',
    'profile.save': 'Save Changes',
    'profile.name': 'Full Name',
    'profile.email': 'Email',
    'profile.phone': 'Phone',
    'profile.grade': 'Grade/Class',
    'profile.school': 'School',
    'profile.bio': 'Bio',
    'profile.avatar': 'Profile Picture',
    'profile.upload': 'Upload Photo',
    'profile.stats': 'Statistics',
    'profile.achievements': 'Achievements',
    'profile.subjects': 'Subject Progress',
    'profile.level': 'Level',
    'profile.xp': 'XP',
    'profile.streak': 'Streak',
    'profile.lessons': 'Lessons Completed',
    
    // Games
    'games.play': 'Play Now',
    'games.score': 'Score',
    'games.time': 'Time',
    'games.level': 'Level',
    'games.difficulty': 'Difficulty',
    
    // Language
    'language.select': 'Select Language',
    'language.change': 'Change Language',
  },
  hi: {
    // Common
    'welcome': 'рд╕реНрд╡рд╛рдЧрдд',
    'home': 'рдореБрдЦреНрдп рдкреГрд╖реНрда',
    'profile': 'рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓',
    'settings': 'рд╕реЗрдЯрд┐рдВрдЧреНрд╕',
    'games': 'рдЦреЗрд▓',
    'lessons': 'рдкрд╛рда',
    'dashboard': 'рдбреИрд╢рдмреЛрд░реНрдб',
    'logout': 'рд▓реЙрдЧ рдЖрдЙрдЯ',
    'save': 'рд╕реЗрд╡ рдХрд░реЗрдВ',
    'cancel': 'рд░рджреНрдж рдХрд░реЗрдВ',
    'edit': 'рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ',
    'delete': 'рд╣рдЯрд╛рдПрдВ',
    'back': 'рд╡рд╛рдкрд╕',
    'next': 'рдЕрдЧрд▓рд╛',
    'previous': 'рдкрд┐рдЫрд▓рд╛',
    'loading': 'рд▓реЛрдб рд╣реЛ рд░рд╣рд╛ рд╣реИ...',
    'error': 'рддреНрд░реБрдЯрд┐',
    'success': 'рд╕рдлрд▓рддрд╛',
    
    // Home page
    'hero.title': 'рд╢реИрдХреНрд╖рдгрд┐рдХ рдЦреЗрд▓ рд╕реНрдЯреЛрд░',
    'hero.subtitle': 'рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдЧреЗрдореНрд╕ рдФрд░ рдЪреБрдиреМрддрд┐рдпреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕реАрдЦрдиреЗ рдХреЛ рдмрдврд╝рд╛рд╡рд╛ рджреЗрдВ',
    'platform.title': 'EduGamers рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИ',
    'platform.subtitle': 'рдкреНрд▓реЗрдЯрдлреЙрд░реНрдо рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдкрдиреА рднреВрдорд┐рдХрд╛ рдЪреБрдиреЗрдВ',
    'role.student': 'рдЫрд╛рддреНрд░',
    'role.teacher': 'рд╢рд┐рдХреНрд╖рдХ',
    'role.government': 'рд╕рд░рдХрд╛рд░',
    'role.student.desc': 'рдЦреЗрд▓ рдЦреЗрд▓реЗрдВ, рдкреНрд░рдЧрддрд┐ рдЯреНрд░реИрдХ рдХрд░реЗрдВ, рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдЬрдорд╛ рдХрд░реЗрдВ',
    'role.teacher.desc': 'рдЫрд╛рддреНрд░реЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░реЗрдВ, рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ рдмрдирд╛рдПрдВ, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рджреЗрдЦреЗрдВ',
    'role.government.desc': 'рдХреНрд╖реЗрддреНрд░реАрдп рдбреЗрдЯрд╛ рджреЗрдЦреЗрдВ, рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдЯреНрд░реИрдХ рдХрд░реЗрдВ, рдиреАрддрд┐рдпреЛрдВ рдХрд╛ рдкреНрд░рдмрдВрдзрди рдХрд░реЗрдВ',
    'explore.games': 'рдЧреЗрдореНрд╕ рдПрдХреНрд╕рдкреНрд▓реЛрд░ рдХрд░реЗрдВ',
    'get.started': 'рд╢реБрд░реБрдЖрдд рдХрд░реЗрдВ',
    'solar.status': 'рд╕реМрд░ рдКрд░реНрдЬрд╛ рд╕рдВрдЪрд╛рд▓рд┐рдд - рд╕рдХреНрд░рд┐рдп',
    
    // Profile page
    'profile.title': 'рдореЗрд░реА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓',
    'profile.edit': 'рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рд╕рдВрдкрд╛рджрд┐рдд рдХрд░реЗрдВ',
    'profile.save': 'рдкрд░рд┐рд╡рд░реНрддрди рд╕реЗрд╡ рдХрд░реЗрдВ',
    'profile.name': 'рдкреВрд░рд╛ рдирд╛рдо',
    'profile.email': 'рдИрдореЗрд▓',
    'profile.phone': 'рдлреЛрди',
    'profile.grade': 'рдЧреНрд░реЗрдб/рдХрдХреНрд╖рд╛',
    'profile.school': 'рд╕реНрдХреВрд▓',
    'profile.bio': 'рдкрд░рд┐рдЪрдп',
    'profile.avatar': 'рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рддрд╕реНрд╡реАрд░',
    'profile.upload': 'рдлреЛрдЯреЛ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ',
    'profile.stats': 'рдЖрдВрдХрдбрд╝реЗ',
    'profile.achievements': 'рдЙрдкрд▓рдмреНрдзрд┐рдпрд╛рдВ',
    'profile.subjects': 'рд╡рд┐рд╖рдп рдкреНрд░рдЧрддрд┐',
    'profile.level': 'рд╕реНрддрд░',
    'profile.xp': 'XP',
    'profile.streak': 'рд╕реНрдЯреНрд░реАрдХ',
    'profile.lessons': 'рдкреВрд░реНрдг рдкрд╛рда',
    
    // Games
    'games.play': 'рдЕрднреА рдЦреЗрд▓реЗрдВ',
    'games.score': 'рд╕реНрдХреЛрд░',
    'games.time': 'рд╕рдордп',
    'games.level': 'рд╕реНрддрд░',
    'games.difficulty': 'рдХрдард┐рдирд╛рдИ',
    
    // Language
    'language.select': 'рднрд╛рд╖рд╛ рдЪреБрдиреЗрдВ',
    'language.change': 'рднрд╛рд╖рд╛ рдмрджрд▓реЗрдВ',
  },
  or: {
    // Common
    'welcome': 'рм╕рнНрн▒рм╛рмЧрмд',
    'home': 'рморнБрмЦрнНрнЯ рмкрнГрм╖рнНрмарм╛',
    'profile': 'рмкрнНрм░рнЛрмлрм╛рмЗрм▓рнН',
    'settings': 'рм╕рнЗрмЯрм┐рмВ',
    'games': 'рмЦрнЗрм│',
    'lessons': 'рмкрм╛рма',
    'dashboard': 'рмбрнНрнЯрм╛рм╕рммрнЛрм░рнНрмб',
    'logout': 'рм▓рмЧрнН рмЖрмЙрмЯрнН',
    'save': 'рм╕рнЗрмнрнН рмХрм░рмирнНрмдрнБ',
    'cancel': 'рммрм╛рмдрм┐рм▓рнН рмХрм░рмирнНрмдрнБ',
    'edit': 'рм╕рмВрмкрм╛рмжрмирм╛ рмХрм░рмирнНрмдрнБ',
    'delete': 'рмбрм┐рм▓рм┐рмЯрнН рмХрм░рмирнНрмдрнБ',
    'back': 'рмкрмЫрмХрнБ',
    'next': 'рмкрм░рммрм░рнНрмдрнНрмдрнА',
    'previous': 'рмкрнВрм░рнНрммрммрм░рнНрмдрнНрмдрнА',
    'loading': 'рм▓рнЛрмбрм╝рм┐рмЩрнНрмЧ...',
    'error': 'рмдрнНрм░рнБрмЯрм┐',
    'success': 'рм╕рмлрм│рмдрм╛',
    
    // Home page
    'hero.title': 'рм╢рм┐рмХрнНрм╖рм╛рмЧрмд рмЦрнЗрм│ рм╖рнНрмЯрнЛрм░рнН',
    'hero.subtitle': 'рмЗрмгрнНрмЯрм░рм╛рмХрнНрмЯрм┐рмнрнН рмЧрнЗрморнН рмПрммрмВ рмЪрнНрнЯрм╛рм▓рнЗрмЮрнНрмЬ рморм╛рмзрнНрнЯрморм░рнЗ рм╢рм┐рмХрнНрм╖рм╛рмХрнБ рммрнГрмжрнНрмзрм┐ рмХрм░рмирнНрмдрнБ',
    'platform.title': 'EduGamers рм░рнЗ рмЖрмкрмгрмЩрнНрмХрнБ рм╕рнНрн▒рм╛рмЧрмд',
    'platform.subtitle': 'рмкрнНрм▓рм╛рмЯрмлрм░рнНрмо рмЖрмХрнНрм╕рнЗрм╕рнН рмХрм░рм┐рммрм╛рмХрнБ рмЖрмкрмгрмЩрнНрмХрм░ рмнрнВрморм┐рмХрм╛ рммрм╛рмЫрмирнНрмдрнБ',
    'role.student': 'рмЫрм╛рмдрнНрм░',
    'role.teacher': 'рм╢рм┐рмХрнНрм╖рмХ',
    'role.government': 'рм╕рм░рмХрм╛рм░',
    'role.student.desc': 'рмЦрнЗрм│ рмЦрнЗрм│рмирнНрмдрнБ, рмкрнНрм░рмЧрмдрм┐ рмЯрнНрм░рм╛рмХрнН рмХрм░рмирнНрмдрнБ, рмЖрм╕рм╛рмЗрмирморнЗрмгрнНрмЯ рмЬрморм╛ рмХрм░рмирнНрмдрнБ',
    'role.teacher.desc': 'рмЫрм╛рмдрнНрм░рморм╛рмирмЩрнНрмХрнБ рмкрм░рм┐рмЪрм╛рм│рмирм╛ рмХрм░рмирнНрмдрнБ, рмЖрм╕рм╛рмЗрмирморнЗрмгрнНрмЯ рмдрм┐рмЖрм░рм┐ рмХрм░рмирнНрмдрнБ, рммрм┐рм╢рнНрм│рнЗрм╖рмг рмжрнЗрмЦрмирнНрмдрнБ',
    'role.government.desc': 'рмЖрмЮрнНрмЪрм│рм┐рмХ рмдрмернНрнЯ рмжрнЗрмЦрмирнНрмдрнБ, рмХрм╛рм░рнНрмпрнНрнЯрмХрм╛рм░рм┐рмдрм╛ рмЯрнНрм░рм╛рмХрнН рмХрм░рмирнНрмдрнБ, рмирнАрмдрм┐ рмкрм░рм┐рмЪрм╛рм│рмирм╛ рмХрм░рмирнНрмдрнБ',
    'explore.games': 'рмЧрнЗрморнНрм╕ рмПрмХрнНрм╕рмкрнНрм▓рнЛрм░рнН рмХрм░рмирнНрмдрнБ',
    'get.started': 'рмЖрм░рморнНрмн рмХрм░рмирнНрмдрнБ',
    'solar.status': 'рм╕рнМрм░ рм╢рмХрнНрмдрм┐ рмЪрм╛рм│рм┐рмд - рм╕рмХрнНрм░рм┐рнЯ',
    
    // Profile page
    'profile.title': 'рморнЛрм░ рмкрнНрм░рнЛрмлрм╛рмЗрм▓рнН',
    'profile.edit': 'рмкрнНрм░рнЛрмлрм╛рмЗрм▓рнН рм╕рмВрмкрм╛рмжрмирм╛ рмХрм░рмирнНрмдрнБ',
    'profile.save': 'рмкрм░рм┐рммрм░рнНрмдрнНрмдрми рм╕рнЗрмнрнН рмХрм░рмирнНрмдрнБ',
    'profile.name': 'рмкрнВрм░рнНрмгрнНрмг рмирм╛рмо',
    'profile.email': 'рмЗрморнЗрм▓рнН',
    'profile.phone': 'рмлрнЛрмирнН',
    'profile.grade': 'рмЧрнНрм░рнЗрмбрнН/рмХрнНрм▓рм╛рм╕рнН',
    'profile.school': 'рммрм┐рмжрнНрнЯрм╛рм│рнЯ',
    'profile.bio': 'рмкрм░рм┐рмЪрнЯ',
    'profile.avatar': 'рмкрнНрм░рнЛрмлрм╛рмЗрм▓рнН рмлрмЯрнЛ',
    'profile.upload': 'рмлрмЯрнЛ рмЕрмкрм▓рнЛрмбрнН рмХрм░рмирнНрмдрнБ',
    'profile.stats': 'рмкрм░рм┐рм╕рмВрмЦрнНрнЯрм╛рми',
    'profile.achievements': 'рм╕рмлрм│рмдрм╛',
    'profile.subjects': 'рммрм┐рм╖рнЯ рмкрнНрм░рмЧрмдрм┐',
    'profile.level': 'рм╕рнНрмдрм░',
    'profile.xp': 'XP',
    'profile.streak': 'рм╖рнНрмЯрнНрм░рм┐рмХрнН',
    'profile.lessons': 'рм╕рморнНрмкрнВрм░рнНрмгрнНрмг рмкрм╛рма',
    
    // Games
    'games.play': 'рммрм░рнНрмдрнНрмдрморм╛рми рмЦрнЗрм│рмирнНрмдрнБ',
    'games.score': 'рм╕рнНрмХрнЛрм░рнН',
    'games.time': 'рм╕рморнЯ',
    'games.level': 'рм╕рнНрмдрм░',
    'games.difficulty': 'рмХрмарм┐рмирмдрм╛',
    
    // Language
    'language.select': 'рмнрм╛рм╖рм╛ рммрм╛рмЫрмирнНрмдрнБ',
    'language.change': 'рмнрм╛рм╖рм╛ рммрмжрм│рм╛рмирнНрмдрнБ',
  },
}

interface LanguageContextType {
  currentLanguage: Language
  setLanguage: (language: Language) => void
  t: (key: string) => string
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined)

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [currentLanguage, setCurrentLanguage] = useState<Language>(supportedLanguages[0])
  const [isInitialized, setIsInitialized] = useState(false)

  useEffect(() => {
    // Load saved language from localStorage only on client side
    if (typeof window !== 'undefined') {
      const savedLanguage = localStorage.getItem('selectedLanguage')
      if (savedLanguage) {
        const language = supportedLanguages.find(lang => lang.code === savedLanguage)
        if (language) {
          setCurrentLanguage(language)
        }
      }
    }
    setIsInitialized(true)
  }, [])

  const setLanguage = (language: Language) => {
    setCurrentLanguage(language)
    // Only save to localStorage if we're on the client side
    if (typeof window !== 'undefined') {
      localStorage.setItem('selectedLanguage', language.code)
    }
  }

  const t = (key: string): string => {
    const languageTranslations = translations[currentLanguage.code]
    return languageTranslations?.[key] || translations.en[key] || key
  }

  return (
    <LanguageContext.Provider value={{ currentLanguage, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  )
}

export function useLanguage() {
  const context = useContext(LanguageContext)
  if (context === undefined) {
    throw new Error('useLanguage must be used within a LanguageProvider')
  }
  return context
}
